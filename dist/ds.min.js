/*! ds - v0.0.1 - 2014-05-03
* https://github.com/jonniespratley/ds
* Copyright (c) 2014 Jonnie Spratley; Licensed MIT */
!function(a){"use strict";a.DS=function(a){var b=require("mongoose"),c=require("promised-io/promise").Deferred,d=null,e={},f={};return f.connect=function(c){if(a.models)for(var f in a.models)if(f){var g=b.model(f,new b.Schema(a.models[f]));e[f]=g}return d=b.connect("mongodb://"+c),this},f.model=function(a,c){return b.model(a,new b.Schema(c))},f.findAll=function(a){var b=new c;if(!e[a])throw new Error("Must add table to options.");return e[a].find(function(a,c){a?b.reject(a):b.resolve(c)}),b.promise},f.findOne=function(a,b){var d=new c;if(!e[a])throw new Error("Must add table to options.");return e[a].findById(b,function(a,b){a?d.reject(a):d.resolve(b)}),d.promise},f.create=function(a,b){var d=new c;if(!e[a])throw new Error("Must add table to options.");var f=new e[a](b);return f.save(function(a,b){a?d.reject(a):d.resolve(b)}),d.promise},f.update=function(a,b,d){var f=new c;return e[a].findByIdAndUpdate(b,d,function(a,b){a?f.reject(a):f.resolve(b)}),f.promise},f.destroy=function(a,b){var d=new c;return e[a].findByIdAndRemove(b,function(a,b){a?d.reject(a):d.resolve(b)}),d.promise},a.host?f.connect(a.host):f}}("object"==typeof exports&&exports||this);